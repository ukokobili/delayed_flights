version: 2

models:
  - name: facts
    description: >-
      CTE for processing flight delays and cancellations, including surrogate keys for dimensions and relevant flight metrics.
    columns:
      - name: fct_delay_key
        description: Surrogate key for flight delay facts.
        meta:
          dimension:
            type: string

      - name: date_day_key
        description: Surrogate key for the date.
        meta:
          dimension:
            type: string

      - name: _cancelled_key
        description: Surrogate key for cancellations based on tail number.
        meta:
          dimension:
            type: string

      - name: airports_id_key
        description: Surrogate key for airport ID.
        meta:
          dimension:
            type: string

      - name: weather_meteo_key
        description: Surrogate key for linking weather data.
        meta:
          dimension:
            type: string

      - name: flight_date
        description: Date of the flight.
        meta:
          dimension:
            type: date

      - name: dep_delay
        description: Departure delay in minutes.
        meta:
          dimension:
            type: int

      - name: cancelled
        description: Cancellation status (boolean or integer).
        meta:
          dimension:
            type: int

      - name: diverted
        description: Diversion status (boolean or integer).
        meta:
          dimension:
            type: int

      - name: dep_delay_tag
        description: Categorization tag for departure delays.
        meta:
          dimension:
            type: string

      - name: arr_delay
        description: Arrival delay in minutes.
        meta:
          dimension:
            type: int

      - name: arr_delay_type
        description: Type of arrival delay.
        meta:
          dimension:
            type: string

      - name: flight_duration
        description: Duration of the flight in minutes.
        meta:
          dimension:
            type: int

      - name: distance_type
        description: Classification of flight distance.
        meta:
          dimension:
            type: string

      - name: delay_carrier
        description: Delays caused by the carrier.
        meta:
          dimension:
            type: int

      - name: delay_weather
        description: Delays due to weather conditions.
        meta:
          dimension:
            type: int

      - name: delay_nas
        description: Delays due to National Airspace System.
        meta:
          dimension:
            type: int

      - name: delay_security
        description: Delays due to security issues.
        meta:
          dimension:
            type: int

      - name: delay_last_aircraft
        description: Delays due to the late arrival of the aircraft used for the flight.
        meta:
          dimension:
            type: int

      - name: loaded_at
        description: Timestamp when the record was processed.
        meta:
          dimension:
            type: timestamp

    config:
      materialized: table
      partition_by:
        field: flight_date
        data_type: date
