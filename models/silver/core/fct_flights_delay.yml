version: 2

models:
  - name: facts
    description: >-
      CTE for organizing detailed flight delay and status data, including surrogate keys for dimensions and essential flight data.
    columns:
      - name: fct_delay_key
        description: Unique key for flight delay instances.
        meta:
          dimension:
            type: string

      - name: date_day_key
        description: Unique key for date dimension.
        meta:
          dimension:
            type: string

      - name: us_flight_key
        description: Unique key for flights based on tail number.
        meta:
          dimension:
            type: string

      - name: airports_geolocation_key
        description: Unique key for linking airport geolocation data.
        meta:
          dimension:
            type: string

      - name: weather_meteo_key
        description: Unique key for linking weather data.
        meta:
          dimension:
            type: string

      - name: flight_date
        description: Date of the flight.
        meta:
          dimension:
            type: date

      - name: dep_delay
        description: Departure delay in minutes.
        meta:
          dimension:
            type: int

      - name: dep_delay_tag
        description: Categorization of departure delay.
        meta:
          dimension:
            type: string

      - name: arr_delay
        description: Arrival delay in minutes.
        meta:
          dimension:
            type: int

      - name: flight_duration
        description: Total duration of the flight.
        meta:
          dimension:
            type: int

      - name: delay_carrier
        description: Minutes delayed due to carrier issues.
        meta:
          dimension:
            type: int

      - name: delay_weather
        description: Minutes delayed due to weather conditions.
        meta:
          dimension:
            type: int

      - name: delay_nas
        description: Minutes delayed due to NAS.
        meta:
          dimension:
            type: int

      - name: delay_security
        description: Minutes delayed due to security issues.
        meta:
          dimension:
            type: int

      - name: delay_last_aircraft
        description: Minutes delayed due to the last aircraft's delay.
        meta:
          dimension:
            type: int

      - name: aicraft_age
        description: Age of the aircraft.
        meta:
          dimension:
            type: int

      - name: loaded_at
        description: Timestamp when the record was processed.
        meta:
          dimension:
            type: timestamp

    config:
      materialized: table
      partition_by:
        field: flight_date
        data_type: date
